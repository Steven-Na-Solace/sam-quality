# Solace Agent Mesh Agent Configuration

log:
  stdout_log_level: INFO
  log_file_level: DEBUG
  log_file: a2a_agent.log

!include ../shared_config.yaml

apps:
  - name: "GetResultsByDefectType.__app"
    app_base_path: .
    app_module: solace_agent_mesh.agent.sac.app
    broker:
      <<: *broker_connection

    app_config:
      namespace: "${NAMESPACE}"
      supports_streaming: true
      agent_name: "GetResultsByDefectType"
      display_name: "Get Quality Results by Defect Type"
      model: *general_model

      instruction: |
        Returns all quality inspection results filtered by a specific defect type from the SECOM MES database.
        Supports defect types: Scratch, Particle, Pattern, None, Contamination, Crack.

      tools:
        - component_base_path: .
          component_module: src.quality.quality_api
          function_name: get_results_by_defect_type
          tool_description: Returns all quality inspection results filtered by a specific defect type from the SECOM MES database.
          tool_name: get_results_by_defect_type
          tool_type: python

      session_service:
        type: "sql"
        default_behavior: "PERSISTENT"
        database_url: "${GET_RESULTS_BY_DEFECT_TYPE_DATABASE_URL, sqlite:///get_results_by_defect_type.db}"
      artifact_service: *default_artifact_service

      artifact_handling_mode: "reference"
      enable_embed_resolution: true
      enable_artifact_content_instruction: true
      data_tools_config: *default_data_tools_config

      # Agent Card Definition
      agent_card:
        description: |
          Returns all quality inspection results filtered by a specific defect type from the SECOM MES database.
          Supports defect-specific analysis, identifying equipment or process issues related to particular defect categories.
        defaultInputModes: [object]
        defaultOutputModes: [object]
        skills:
          - description: 'Retrieves all quality inspection results filtered by a specific defect type.
                 Supports defect-specific analysis, identifying equipment or process issues
                 related to particular defect categories, and targeted quality improvement.'
            id: get_results_by_defect_type
            name: Get Quality Results by Defect Type
            input_schema:
              type: object
              required:
                - defect_type
              properties:
                defect_type:
                  type: string
                  description: Type of defect to filter by
                  example: "electrical_fail"
                  enum: ["contamination", "dimensional_oor", "electrical_fail", "surface_defect"]

            output_schema:
              type: array
              description: List of quality results filtered by defect type
              items:
                type: object
                properties:
                  resultId:
                    type: integer
                    format: int32
                    description: Unique quality result identifier
                  lot:
                    type: object
                    description: Associated lot information with lotId, lotNumber, productType, equipment, operator, shift, status
                  classification:
                    type: integer
                    format: int32
                    description: Classification result (-1 = Pass, 1 = Fail)
                  testTimestampRaw:
                    type: string
                    description: Raw test timestamp string
                  testDatetime:
                    type: string
                    format: date-time
                    description: Date and time of test
                  predictedRisk:
                    type: number
                    format: float
                    description: Predicted risk score (0.0 to 1.0)
                  riskScore:
                    type: number
                    format: float
                    description: Risk score
                  riskFactors:
                    type: string
                    description: Risk factors identified
                  modelVersion:
                    type: string
                    description: ML model version used for prediction
                  qualityScore:
                    type: number
                    format: float
                    description: Quality score
                  defectType:
                    type: string
                    description: Type of defect (matches input filter)
                  defectCode:
                    type: string
                    description: Defect code
                  defectLocation:
                    type: string
                    description: Location of defect
                  inspector:
                    type: object
                    description: Inspector operator information
                  notes:
                    type: string
                    description: Inspection notes
                  reviewer:
                    type: object
                    description: Reviewer operator information
                  reviewedAt:
                    type: string
                    format: date-time
                    description: Review timestamp
                  disposition:
                    type: string
                    description: Disposition decision
                  createdAt:
                    type: string
                    format: date-time
                    description: Record creation timestamp
                  updatedAt:
                    type: string
                    format: date-time
                    description: Record update timestamp

      # Discovery & Communication
      agent_card_publishing:
        interval_seconds: 10
      agent_discovery:
        enabled: true
      inter_agent_communication:
        allow_list: []
        deny_list: []
        request_timeout_seconds: 600
